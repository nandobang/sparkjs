window.Spark=window.Spark||{},window.Spark.Color=function(a){this.value=a.value||"#000000",this.toString=function(){return this.value}},window.Spark.ColorStop=function(a){this.position=a.position,this.color=a.color||new Spark.Color},window.Spark.Core=function(){var a=this,b=0,c=0,d=function(b){a.context.save(),a.context.translate(b.positionX,b.positionY),a.context.rotate(Math.degToRad(b.rotation)),a.context.scale(b.scaleX,b.scaleY),a.context.translate(b.offsetX,b.offsetY)},e=function(){a.context.restore()},f=function(b){var c;if(b instanceof Spark.Gradient){c=b.type==Spark.GradientType.RADIAL?a.context.createRadialGradient(b.startX,b.startY,b.innerRadius,b.endX,b.endY,b.outerRadius):a.context.createLinearGradient(b.startX,b.startY,b.endX,b.endY);for(var d=0;d<b.colorStops.length;d++){var e=b.colorStops[d];c.addColorStop(e.position||1/(b.colorStops.length-1)*d,e.color.value)}}else c=b instanceof Spark.Color?b.value:b;return c||"transparent"},g=function(b,c,d){a.context.fillStyle=f(b),a.context.strokeStyle=f(c),a.context.lineWidth=d,b&&a.context.fill(),c&&a.context.stroke()},h=function(b,c,d,e){a.context.fillStyle=f(c),a.context.strokeStyle=f(d),a.context.lineWidth=e,c&&a.context.fillText(b,0,0),d&&a.context.strokeText(b,0,0)};this.canvas={},this.context={},this.deltaTime=0,this.fps=0,this.showFps=!1,this.setup=function(a,b,c){if("undefined"!=typeof a){var d="canvasIdeCanvas";document.getElementById(a).innerHTML='<canvas id="'+d+'"></canvas>',this.canvas=document.getElementById(d),this.canvas.setAttribute("width",b),this.canvas.setAttribute("height",c),this.context=this.canvas.getContext("2d"),this.setupRequestAnimationFrame()}},this.setMainLoop=function(d){!function e(){window.requestAnimationFrame(e),a.deltaTime=Date.now(),Date.now()-c>1e3&&(c=Date.now(),a.fps=b,b=0),a.clear(),d(),a.showFps===!0&&a.drawText({transform:{positionX:630,positionY:20},text:"FPS: "+cc.fps,alignment:"end",fill:"#f00"}),a.deltaTime=Date.now()-a.deltaTime,b++}()},this.clear=function(){this.canvas.width=this.canvas.width},this.setupRequestAnimationFrame=function(){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)};window.requestAnimationFrame=a},this.drawText=function(a){d(a.transform),this.context.font=[a.fontStyle||"",(a.fontSize||12)+"pt",a.fontFamily||"Courier"].join(" "),this.context.textAlign=a.alignment||"start",h(a.text,a.fill||"#000",a.stroke,a.strokeWidth),e()},this.drawRect=function(a){d(a.transform),this.context.beginPath(),this.context.rect(0,0,a.width,a.height),this.context.closePath(),g(a.fill,a.stroke,a.strokeWidth),e()},this.drawEllipse=function(a){d(a.transform),this.context.beginPath();var b=.551915024494,c=b*(a.width/2),f=a.height/2,h=a.width/2,i=-b*f,j=b*f;this.context.moveTo(0+h,0),this.context.bezierCurveTo(c+h,-f+f,h+h,i+f,h+h,0+f),this.context.bezierCurveTo(h+h,j+f,c+h,f+f,0+h,f+f),this.context.bezierCurveTo(-c+h,f+f,-h+h,j+f,-h+h,0+f),this.context.bezierCurveTo(-h+h,i+f,-c+h,-f+f,0+h,-f+f),this.context.closePath(),g(a.fill,a.stroke,a.strokeWidth),e()},this.drawCircle=function(a){this.drawEllipse({transform:a.transform,width:2*a.radius,height:2*a.radius,fill:a.fill,stroke:a.stroke,strokeWidth:a.strokeWidth})},this.drawLine=function(a){d(a.transform),this.context.beginPath(),this.context.moveTo(0,0),this.context.lineTo(a.endX,a.endY),g(a.fill,a.stroke,a.strokeWidth),e()},this.drawArc=function(a){d(a.transform),this.context.beginPath(),this.context.arc(0,0,a.radius,Math.degToRad(a.startAngle),Math.degToRad(a.endAngle)),g(a.fill,a.stroke,a.strokeWidth),e()},this.drawBezierCurve=function(a){d(a.transform),this.context.beginPath(),this.context.moveTo(0,0),this.context.bezierCurveTo(a.anchor1X,a.anchor1Y,a.anchor2X,a.anchor2Y,a.endX,a.endY),g(a.fill,a.stroke,a.strokeWidth),e()},this.drawQuadraticCurve=function(a){d(a.transform),this.context.beginPath(),this.context.moveTo(0,0),this.context.quadraticCurveTo(a.anchorX,a.anchorY,a.endX,a.endY),g(a.fill,a.stroke,a.strokeWidth),e()},this.drawImage=function(a){d(a.transform),a.clip&&(this.context.beginPath(),this.context.rect(a.clip.x,a.clip.y,a.clip.width,a.clip.height),this.context.clip()),this.context.drawImage(a.image.get(),0,0),e()},this.drawSprite=function(a){var b=a.image.get().width/a.columns,c=a.image.get().height/a.rows;d(a.transform),(a.columns>1||a.rows>1)&&(this.context.beginPath(),this.context.rect(0,0,b,c),this.context.clip()),this.context.drawImage(a.image.get(),0-a.tileColumn*b,0-a.tileRow*c),e()},this.drawPath=function(a){d(a.transform);var b;this.context.beginPath(),this.context.moveTo(a.startingPoint.x,a.startingPoint.y);for(var c=0;c<a.segments.length;c++)b=a.segments[c],this.context.lineTo(b.x,b.y);this.context.closePath(),g(a.fill,a.stroke,a.strokeWidth),e()}},window.Spark.Gradient=function(a){this.type=a.type||Spark.GradientType.LINEAR,this.colorStops=a.colorStops||[],this.startX=a.startX||0,this.startY=a.startY||0,this.endX=a.endX||0,this.endY=a.endY||0,this.innerRadius=a.innerRadius||0,this.outerRadius=a.outerRadius||1},window.Spark.GradientType={LINEAR:"linear",RADIAL:"radial"},window.Spark.Image=function(a){var b=new Image;this.get=function(){return b},this.loadFromUrl=function(a){b.src=a},this.loadFromBase64=function(a,c){b.src="data:image/"+a+";base64,"+c},a.url?b.src=a.url:a.type&&a.content&&(b.src="data:image/"+a.type+";base64,"+a.content)},window.Spark.Transform=function(a){this.positionX=a.positionX||0,this.positionY=a.positionY||0,this.rotation=a.rotation||0,this.scaleX=a.scaleX||1,this.scaleY=a.scaleY||1,this.offsetX=a.offsetX||0,this.offsetY=a.offsetY||0};